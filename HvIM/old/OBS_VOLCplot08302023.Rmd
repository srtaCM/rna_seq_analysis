---
title: "Volcano Plot"
output: html_volplot.rmd
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
setwd("~/Desktop/Lab/Coding")
read.counts <- read.table ("~/Desktop/Lab/Coding/featurecount.readcount.txt.gz", header = TRUE)

row.names(read.counts) <- read.counts$Geneid #gene ids will be stored as row names
read.counts <- read.counts [ ,-c(1:6)] #removes columns without gene counts

#giving the columns names
orig_names <- names (read.counts) 
names(read.counts) <- c("PIT1", "PIT2", "PIT3", "PIT4", "PIT5", "PIC1", "PIC2", "PIC3", "PIC4", "PIC5", "PMT1", "PMT2", "PMT3", "PMT4", "PMT5", "PMC1", "PMC2", "PMC3", "PMC4")
str(read.counts)
head(read.counts)
```
```{r}
sample_info <- data.frame(condition = gsub ( "_[0 -9]+ " , " " , names (read.counts)),
    row.names = names(read.counts))
library(BiocManager)
#BiocManager::install('EnhancedVolcano')
library(EnhancedVolcano)
library(ggplot2)
library(ggrepel)
```


```{r}
#install.packages("tidyverse")
library(tidyverse)
library(magrittr)
#install.packages("hms")
#install.packages("kableExtra", dependencies = TRUE)

# A short function for outputting the tables
knitr_table <- function(x) {
  x %>% 
    knitr::kable(format = "html", digits = Inf, 
                 format.args = list(big.mark = ",")) %>%
    kableExtra::kable_styling(font_size = 15)
}
data <- (read.counts)
dim(data)

head(data) %>% 
 knitr_table()
```


```{r}
p1 <- ggplot(data, aes(logFC, -log(FDR,10))) + # -log10 conversion  
  geom_point(size = 2/5) +
  xlab(expression("log"[2]*"FC")) + 
  ylab(expression("-log"[10]*"FDR"))
p1
```

```{r}
#install.packages('devtools')
library(devtools)
library(
df <- RVA::Sample_summary_statistics_table
df1 <- RVA::Sample_summary_statistics_table1 
d1 <- list(df, df1)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

