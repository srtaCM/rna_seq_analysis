---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
#install one
#BiocManager::install(c("DEGreport"))

#remove.packages(ComplexHeatmap)
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(DEGreport)
library(RColorBrewer)
library(DESeq2)
library(pheatmap)
```

```{r}
setwd ("~/Desktop/Lab/Working_Projects/R_trapseq_2023")
norm.counts<-read.csv("./DerivedData/1_normalized_counts.csv")
norm.counts<- as.data.frame(norm.counts, row.names = norm.counts$X)
norm.counts <- norm.counts [ ,-c(1)]

dds<- read.csv("./DerivedData/1_degDESeqDataSetFromMatrix.csv")
dds<- as.data.frame(dds, row.names = dds$X)
```

```{r}
# Create tibbles including row names
#Variables
sample_info <- data.frame(
  sample = c( "H-107", "H-108", "H-109", "H-110", "H-111", "IM-206", "IM-207", "IM-208", "IM-209", "IM-210", "UM-204", "UM-208", "UM-213", "UM-214", "UM-215"),
  groups = c( "H", "H", "H", "H", "H", "IM", "IM", "IM", "IM", "IM", "UM", "UM", "UM", "UM", "UM"),
  condition = c("Infected", "Infected", "Infected", "Infected", "Infected", "Infected", "Infected", "Infected", "Infected", "Infected", "Uninfected", "Uninfected", "Uninfected", "Uninfected", "Uninfected"),
  replicate = c("H-107", "H-108", "H-109", "H-110", "H-111", "IM-206", "IM-207", "IM-208", "IM-209", "IM-210", "UM-204", "UM-208", "UM-213", "UM-214", "UM-215"),
  row.names = "sample") 

sample_info$groups <- as.factor (sample_info$groups)


meta <- sample_info %>% 
  rownames_to_column(var="samplename") %>% 
  as_tibble()
        
normalized_counts <- norm.counts %>% 
  data.frame() %>%
  rownames_to_column(var="gene") %>% 
  as_tibble()
```

```{r}
plotCounts(dds, gene="AT1G01090
", intgroup="groups") 
```

