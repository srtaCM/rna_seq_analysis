---
title: "sRNA seq data"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
setwd("~/Desktop/Lab/sRNA_2023")
library(readxl)
library(readr)

desDatares <- read_excel("~/Desktop/Lab/sRNA_2023/data0_3_5_update_results2.xlsx", 
    sheet = "normalised counts")
head(desDatares)


library(stringr)
res.count <- desDatares %>%
      mutate_at("...1", str_replace, "gene:", "") #fix the names

res.count <- data.frame(res.count, row.names = res.count$...1 ) #gene ids stored as row names
res.count<-res.count[ ,-c(1)] #remove row
```

```{r}
library(corrplot)
library(magrittr)
library(ggfortify)
library(ggforce)
library(ggrepel)
library (ggplot2)
library(pheatmap)
library(devtools)

# cor () calculates the correlation between columns of a matrix
distance.m <- as.dist (1 - cor( res.count , method = "pearson" ))

# plot () the output of hclust ()
hc<- hclust(distance.m)
hcd<-as.dendrogram(hc)

hcd <- hcd %>% 
  color_branches(k = 3)

plot(hcd,
     type = "rectangle", ylab = "Height",
     main = " vst transformed read counts \n distance : Pearson correlation ") 
#dev.copy2pdf(file="Distancedend.pdf")
#saved as of 11.26.2023


```

